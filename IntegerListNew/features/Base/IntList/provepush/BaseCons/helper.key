\predicates {
	containsNewTop(int[], int);
	containsOldElements(int[], int[]);
	lastElementIsNew(int[], int);
}

\rules {
	containsNewTop{
		\schemaVar \term int[] list;
		\schemaVar \term int new;
		\schemaVar \variable int z;
		\find (containsNewTop(list, new))
		\varcond (\notFreeIn(z, list), \notFreeIn(z, new))
		\replacewith ((\exists z; (0 <= z & z < list.length -> list[z] = new)))
		\heuristics(simplify)
	};

	containsOldElements{
		\schemaVar \term int[] list;
		\schemaVar \term int[] oldList;
		\schemaVar \variable int z;
		\schemaVar \variable int k;
		\find (containsOldElements(list, oldList))
		\varcond (\notFreeIn(z, list), \notFreeIn(z, oldList), \notFreeIn(k, list), \notFreeIn(k, oldList))
		\replacewith (((\forall k; (0 <= k & k < oldList.length -> (\exists z; (0 <= z & z < list.length & list[z] = oldList[k]))))))
		\heuristics(simplify)
	};

	lastElementIsNew{
		\schemaVar \term int[] list;
		\schemaVar \term int new;
		\find (lastElementIsNew(list, new))
		\replacewith (list[list.length - 1] = new)
		\heuristics(simplify)
	};

}